extend header

block content 

  pre
    // pre=JSON.stringify(locals, 2, null)
    a.col-md-2(href='/')
      img(src='/images/logo.png')

    form.form(action='/hit', method='GET')
      div.col-md-3
        div.form-group
          label.col-sm-3.control-label Gene Name:
          div.col-sm-9
            input.form-control(type='text', name='name', value=options.name)
        div.form-group
          label.col-sm-3.control-label(for='protein.desc') Description:
          div.col-sm-9
            input.form-control(type='text', name='protein.desc', value=options['protein.desc'])
        div.form-group
          label.col-sm-3.control-label(for='contig.seq') Sequence:
          div.col-sm-9
            textarea.form-control(name='contig.seq')=options['contig.seq']

      div.col-md-2
        div.form-group
          label.col-sm-3.control-label Uniprot:
          div.col-sm-9
            input.form-control(type='text', name='uniprot', value=options.uniprot)
        div.form-group
          label.col-sm-3.control-label Species:
          div.col-sm-9
            select.form-control(name='species', value=options.species)
              option(default, value='', selected=options.species === '') -- select --
              option(value='shehate', selected=options.species === 'shehate') shehate
              option(value='tropicalis', selected=options.species === 'tropicalis') tropicalis
              option(value='boidinii', selected=options.species === 'boidinii') boidinii
        div.form-group
          label.col-sm-3.control-label(for='limit') Limit:        
          div.col-sm-9
            input.form-control(type='number', name='limit', value=options.limit)
        div.form-group
          button.form-control search

    div.col-md-5
      p
        | Candida Genome annotations for Tropicalis, Boidinii and Shehate.
        | 
        | Search for a gene, by ID, name or description. You can also add a neuclotide snippet to search for.
        | 
        | Created by Owen Garland (owg1@aber.ac.uk).


  if data
    if data[0]._id
      +listItems(data)
    else
      +display(data[0])
      div.hidden-box
  if error
    pre=error

mixin listItems(data)
  div.table-responsive
    table.table
      thead
        tr
          th.col-md-1 Candida Gene Name
          th.col-md-5 Description
          th.col-md-1 Species
          th.col-md-1 Candida Geneome ID
          th.col-md-1 Uniprot ID
      tbody
        each item in data
          tr
            td
              a(href='/hit/' + item._id) #{item.name}
            td
              a(href='/hit/' + item._id) #{item.protein.desc}
            td
              a(href='/hit/' + item._id) #{item.species}
            td.external
              a(href='http://www.candidagenome.org/cgi-bin/locus.pl?dbid=' + item.cgdid) #{item.cgdid}
            td.external
              a(href='http://www.uniprot.org/uniprot/' + item.uniprot) #{item.uniprot}

mixin display(hit)
  div.table-responsive
    table.table
      thead
        tr
          th.col-md-1 Item
          th.col-md-11 Value
      tbody
        tr
          td Gene Name
          td=hit.name
        tr
          td Description
          td=hit.protein.desc
        tr
          td Species
          td=hit.species
        tr
          td Hit ID
          td=hit.hitid
        tr
          td Uniprot ID
          td
            a(href='http://www.uniprot.org/uniprot/' + hit.uniprot) #{hit.uniprot}
        tr
          td Candida Genome ID
          td
            a(href='http://www.candidagenome.org/cgi-bin/locus.pl?dbid=' + hit.cgdid) #{hit.cgdid}
        tr
          td Gene Ontology IDs
          td
            if hit.protein.goids
              each id in hit.protein.goids
                a(href='http://amigo.geneontology.org/amigo/term/' + id) #{id}  
        tr
          td Contig ID
          td=hit.contig.head
        tr
          td Contig Sequence
          td
            div.sequence.col-md-12.contig(start=hit.codingRange.start, end=hit.codingRange.end, fail=hit.codingRange.fail)=hit.contig.seq
            div
              p Copy sequence and +/-   
                input.plusminus(type='number') 
                button.copybutton(data-clipboard-target='.hidden-box') copy
                div.infobox
                  |  
        tr
          td Coding Sequence
          td
            div.sequence.col-md-12.coding=hit.codingseq.seq
        tr
          td Protein Sequence
          td
            div.sequence.col-md-12.protein=hit.protein.seq
